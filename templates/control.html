{% extends "base.html" %}

{% block title %}Controle do Sistema - TempPi{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <h1 class="mb-4"><i class="fas fa-cogs"></i> Painel de Controle</h1>
    </div>
</div>

<div class="row">
    <!-- Coluna de Controles Manuais e Status -->
    <div class="col-lg-4 mb-4">
        <div class="card h-100">
            <div class="card-header">
                <h5><i class="fas fa-toggle-on"></i> Controles Gerais</h5>
            </div>
            <div class="card-body">
                <!-- Modo de Operação -->
                <div class="mb-3">
                    <h6>Modo de Operação</h6>
                    <div class="btn-group w-100" role="group">
                        <input type="radio" class="btn-check" name="system_mode" id="mode-auto" value="0" autocomplete="off" checked>
                        <label class="btn btn-outline-primary" for="mode-auto"><i class="fas fa-robot"></i> Automático</label>
                        
                        <input type="radio" class="btn-check" name="system_mode" id="mode-manual" value="1" autocomplete="off">
                        <label class="btn btn-outline-secondary" for="mode-manual"><i class="fas fa-hand-paper"></i> Manual</label>
                    </div>
                </div>

                <!-- Acionamento Aquecimento -->
                <div class="mb-3">
                    <h6>Controle de Aquecimento (Auto)</h6>
                    <div class="d-grid">
                        <button class="btn btn-danger" id="heating-status-btn" data-status="0">
                            <i class="fas fa-power-off"></i> Ligar Aquecimento
                        </button>
                    </div>
                </div>
                
                <hr>

                <!-- Controles Manuais -->
                <div id="manual-controls" class="disabled">
                    <h6 class="mb-3">Acionamentos Manuais</h6>
                    <div class="d-grid gap-2">
                        <button class="btn btn-outline-success" id="manual-fan-btn"><i class="fas fa-fan"></i> Ventilador</button>
                        <button class="btn btn-outline-success" id="manual-screw-btn"><i class="fas fa-cogs"></i> Rosca de Alimentação</button>
                        <div class="btn-group w-100">
                            <button class="btn btn-outline-success" id="manual-drum-fwd-btn"><i class="fas fa-arrow-up"></i> Tambor Avanço</button>
                            <button class="btn btn-outline-success" id="manual-drum-rev-btn"><i class="fas fa-arrow-down"></i> Tambor Retorno</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Coluna de Ajustes de Temperatura -->
    <div class="col-lg-4 mb-4">
        <div class="card h-100">
            <div class="card-header">
                <h5><i class="fas fa-thermometer-half"></i> Controle de Temperatura</h5>
            </div>
            <div class="card-body">
                <!-- Ajustes do Forno (único com controle) -->
                <form id="temp-settings-form">
                    <h6 class="mb-3">Ajustes do Forno (°C)</h6>
                    <div class="input-group mb-3">
                        <span class="input-group-text" style="width: 150px;">Temp. Forno (Min/Max)</span>
                        <input type="number" class="form-control" id="temp_forno_min" placeholder="Min">
                        <input type="number" class="form-control" id="temp_forno_max" placeholder="Max">
                    </div>
                </form>
                
                <hr>
                
                <!-- Visualização em Tempo Real -->
                <h6 class="mb-3">Visualização em Tempo Real</h6>
                <div class="row g-2">
                    <div class="col-12">
                        <div class="card bg-warning bg-opacity-10">
                            <div class="card-body text-center py-2">
                                <small class="text-muted">Temp Forno</small>
                                <div class="h6 mb-0" id="display_temp_forno">- °C</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="card bg-light">
                            <div class="card-body text-center py-2">
                                <small class="text-muted">Torre Nível 1</small>
                                <div class="h6 mb-0" id="display_temp_torre1">- °C</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="card bg-light">
                            <div class="card-body text-center py-2">
                                <small class="text-muted">Torre Nível 2</small>
                                <div class="h6 mb-0" id="display_temp_torre2">- °C</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="card bg-light">
                            <div class="card-body text-center py-2">
                                <small class="text-muted">Torre Nível 3</small>
                                <div class="h6 mb-0" id="display_temp_torre3">- °C</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="card bg-light">
                            <div class="card-body text-center py-2">
                                <small class="text-muted">Tanque</small>
                                <div class="h6 mb-0" id="display_temp_tanque">- °C</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="card bg-light">
                            <div class="card-body text-center py-2">
                                <small class="text-muted">Saída Gases</small>
                                <div class="h6 mb-0" id="display_temp_gases">- °C</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Coluna de Status e Ajustes -->
    <div class="col-lg-4 mb-4">
        <!-- Status dos Atuadores -->
        <div class="card mb-3">
            <div class="card-header">
                <h6><i class="fas fa-toggle-on"></i> Status dos Atuadores</h6>
            </div>
            <div class="card-body">
                <div class="row g-2">
                    <div class="col-6">
                        <div class="d-flex align-items-center">
                            <i class="fas fa-fan me-2"></i>
                            <small>Ventilador</small>
                            <span class="badge ms-auto" id="status_ventilador">OFF</span>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="d-flex align-items-center">
                            <i class="fas fa-fire me-2"></i>
                            <small>Resistência</small>
                            <span class="badge ms-auto" id="status_resistencia">OFF</span>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="d-flex align-items-center">
                            <i class="fas fa-cogs me-2"></i>
                            <small>Rosca</small>
                            <span class="badge ms-auto" id="status_motor_rosca">OFF</span>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="d-flex align-items-center">
                            <i class="fas fa-sync me-2"></i>
                            <small>Tambor</small>
                            <span class="badge ms-auto" id="status_tambor">OFF</span>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="d-flex align-items-center">
                            <i class="fas fa-arrow-right me-2" id="tambor_direction_icon"></i>
                            <small>Direção Tambor</small>
                            <span class="badge ms-auto" id="status_tambor_dir">--</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ajustes de Pressão e Tempo -->
        <div class="card">
            <div class="card-header">
                <h5><i class="fas fa-tachometer-alt"></i> Ajustes de Pressão e Tempo</h5>
            </div>
            <div class="card-body">
                <form id="pressure-time-settings-form">
                    <h6 class="mb-2">Pressão (bar)</h6>
                    <div class="input-group mb-3">
                        <span class="input-group-text" style="width: 180px;">Pressão Linha (Min/Max)</span>
                        <input type="number" class="form-control" id="pressao_linha_min" placeholder="Min">
                        <input type="number" class="form-control" id="pressao_linha_max" placeholder="Max">
                    </div>
                    <hr>
                    <h6 class="mb-2">Tempo (segundos)</h6>
                    <div class="input-group mb-3">
                        <span class="input-group-text" style="width: 180px;">Acionamento Resistência</span>
                        <input type="number" class="form-control" id="tempo_acionamento_resistencia">
                    </div>
                    <div class="input-group mb-3">
                        <span class="input-group-text" style="width: 180px;">Acionamento Rosca</span>
                        <input type="number" class="form-control" id="tempo_acionamento_rosca">
                    </div>
                    <div class="input-group mb-3">
                        <span class="input-group-text" style="width: 180px;">Pausa Rosca</span>
                        <input type="number" class="form-control" id="tempo_pausa_rosca">
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<style>
    #manual-controls.disabled {
        opacity: 0.5;
        pointer-events: none;
    }
</style>

{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/control.js') }}"></script>
{% endblock %}